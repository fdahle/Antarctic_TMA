import copy
import warnings

from tqdm import tqdm

import image_georeferencing.old.georef_img as gi
import image_georeferencing.old.georef_sat as gs
import image_georeferencing.sub.deleted.derive_image_position as dip

import base.connect_to_db as ctd
import base.print_v as p

#CA182232V0108 CHECK THIS HERE

def georef_all():

    # get all unreferenced images
    sql_string = "SELECT image_id FROM images_extracted WHERE image_id LIKE '%V%'"
    data = ctd.get_data_from_db(sql_string)
    image_ids = data['image_id'].values.tolist()

    # all ids ordered in different categories
    lst_georeferenced = []
    lst_failed = []
    lst_invalid = []
    lst_too_few_tps = []
    lst_complexity = []

    """
    # first we try to geo-reference all images with other satellite images
    print("Geo-reference with satellite images")
    for image_id in (pbar := tqdm(image_ids)):

        p.print_v(f"Work on {image_id} ({len(lst_georeferenced)} georeferenced, {len(lst_failed)} failed, "
                  f"{len(lst_invalid)} invalid, {len(lst_too_few_tps)} too few_tps, "
                  f"{len(lst_complexity)} too simple", pbar=pbar)

        with warnings.catch_warnings():
            warnings.simplefilter("ignore", category=RuntimeWarning)
            status = gs.georef_sat(image_id, overwrite=False, catch=False)

        # best outcome --> image is (already) geo-referenced
        if status == "georeferenced":
            lst_georeferenced.append(image_id)

        # worst outcome --> there's an error
        elif status == "failed":
            lst_failed.append(image_id)

        # we have too few tie-points or these are not good --> we need to try again later
        elif status == "invalid":
            lst_invalid.append(image_id)

        elif status == "too_few_tps":
            lst_too_few_tps.append(image_id)

        elif status == "complexity":
            lst_complexity.append(image_id)

    print("Georeferenced:", len(lst_georeferenced))
    print("Failed:", len(lst_failed))
    print("Invalid:", len(lst_invalid))
    print("Too few tps:", len(lst_too_few_tps))
    print("Complexity:", len(lst_complexity))

    print(lst_invalid)
    print(lst_too_few_tps)
    
    # check image positions if they are valid
    cgf.clean_georef_folder()
    """

    lst_invalid = ['CA216032V0035', 'CA183332V0074', 'CA182632V0129', 'CA196232V0035', 'CA184532V0232', 'CA216132V0053', 'CA184932V0257', 'CA183132V0002', 'CA216632V0317', 'CA182732V0019', 'CA184832V0106', 'CA196832V0137', 'CA184432V0113', 'CA184732V0064', 'CA184532V0250', 'CA182332V0094', 'CA216432V0237', 'CA164432V0028', 'CA181232V0027', 'CA183532V0063', 'CA180432V0200', 'CA184832V0121', 'CA182332V0089', 'CA183532V0012', 'CA196732V0081', 'CA216132V0061', 'CA181532V0016', 'CA204032V0374', 'CA180132V0116', 'CA180432V0199', 'CA204032V0396', 'CA184732V0062', 'CA182132V0152', 'CA184932V0231', 'CA183332V0088', 'CA164432V0078', 'CA184332V0079', 'CA182732V0014', 'CA181632V0104', 'CA184932V0259', 'CA184832V0156', 'CA216132V0054', 'CA198232V0034', 'CA180532V0009', 'CA196632V0056', 'CA184632V0300', 'CA196632V0068', 'CA183532V0014', 'CA184732V0034', 'CA181332V0128', 'CA196232V0040', 'CA184532V0213', 'CA196732V0083', 'CA184632V0310', 'CA182532V0022', 'CA184632V0309', 'CA184432V0177', 'CA164432V0070', 'CA183532V0070', 'CA184432V0184', 'CA183332V0133', 'CA182232V0073', 'CA180232V0169', 'CA196832V0148', 'CA216632V0312', 'CA214232V0124', 'CA184332V0056', 'CA182232V0060', 'CA181832V0016', 'CA164432V0034', 'CA216032V0024', 'CA216332V0167', 'CA182332V0017', 'CA182332V0016', 'CA182232V0082', 'CA181532V0038', 'CA216632V0309', 'CA216332V0176', 'CA214132V0116', 'CA196532V0009', 'CA216632V0266', 'CA181332V0111', 'CA216432V0239', 'CA216632V0298', 'CA213432V0289', 'CA214232V0161', 'CA196532V0006', 'CA183332V0154', 'CA164432V0067', 'CA216032V0012', 'CA216432V0221', 'CA182532V0023', 'CA184532V0229', 'CA183332V0126', 'CA216432V0236', 'CA212132V0060', 'CA183432V0001', 'CA182632V0127', 'CA183232V0069', 'CA181332V0133', 'CA184532V0234', 'CA196332V0061', 'CA216632V0306', 'CA180032V0073', 'CA184732V0094', 'CA184432V0094', 'CA216732V0343', 'CA184932V0238', 'CA180032V0070', 'CA183332V0098', 'CA184632V0313', 'CA182532V0004', 'CA180032V0019', 'CA216432V0190', 'CA184632V0365', 'CA181832V0056', 'CA183332V0052', 'CA216632V0289', 'CA182732V0023', 'CA196932V0183', 'CA216732V0338', 'CA181332V0104', 'CA196932V0161', 'CA182532V0065', 'CA182532V0047', 'CA181832V0015', 'CA196932V0172', 'CA216632V0277', 'CA182232V0010', 'CA216432V0210', 'CA183332V0069', 'CA216732V0336', 'CA180032V0076', 'CA214232V0127', 'CA182732V0037', 'CA180432V0194', 'CA212332V0052', 'CA180032V0079', 'CA181632V0142', 'CA182532V0054', 'CA184932V0264', 'CA216032V0010', 'CA181632V0034', 'CA183532V0040', 'CA212332V0018', 'CA196832V0150', 'CA182532V0010', 'CA184432V0181', 'CA181332V0134', 'CA196332V0064', 'CA182632V0086', 'CA216332V0175', 'CA184532V0242', 'CA184432V0179', 'CA183432V0005', 'CA216732V0340', 'CA216432V0192', 'CA183332V0120', 'CA183532V0032', 'CA216632V0267', 'CA182432V0035', 'CA183532V0058', 'CA183532V0038', 'CA196932V0154', 'CA183232V0050', 'CA212132V0079', 'CA181832V0002', 'CA183532V0080', 'CA184732V0065', 'CA180732V0007', 'CA216132V0048', 'CA180132V0085', 'CA164432V0033', 'CA180032V0071', 'CA183332V0061', 'CA182332V0039', 'CA180032V0023', 'CA216432V0233', 'CA182532V0045', 'CA182532V0012', 'CA184532V0222', 'CA180032V0039', 'CA182532V0014', 'CA183532V0087', 'CA182332V0043', 'CA184532V0248', 'CA216332V0159', 'CA184832V0152', 'CA181532V0015', 'CA213532V0308', 'CA184632V0355', 'CA180332V0181', 'CA184432V0137', 'CA184532V0247', 'CA216032V0015', 'CA196632V0032', 'CA182132V0098', 'CA184632V0351', 'CA182432V0106', 'CA184732V0029', 'CA216132V0074', 'CA184832V0107', 'CA183532V0071', 'CA196932V0167', 'CA216332V0154', 'CA164432V0039', 'CA184332V0035', 'CA216332V0163', 'CA182732V0050', 'CA183532V0089', 'CA183132V0005', 'CA184332V0055', 'CA184632V0379', 'CA181332V0126', 'CA183232V0011', 'CA216132V0075', 'CA216632V0301', 'CA216032V0018', 'CA207332V0118', 'CA182332V0025', 'CA181832V0004', 'CA182532V0081', 'CA184732V0002', 'CA184932V0239', 'CA184532V0233', 'CA214232V0170', 'CA182532V0086', 'CA182232V0085', 'CA196232V0056', 'CA182532V0043', 'CA180332V0182', 'CA184432V0173', 'CA164432V0057', 'CA180032V0037', 'CA216032V0032', 'CA182532V0035', 'CA180132V0100', 'CA184932V0192', 'CA184532V0230', 'CA181532V0001', 'CA182532V0113', 'CA181832V0001', 'CA196532V0023', 'CA184832V0120', 'CA181532V0032', 'CA183332V0079', 'CA184532V0205', 'CA184732V0049', 'CA183332V0122', 'CA183532V0076', 'CA184932V0275', 'CA183432V0007', 'CA184632V0340', 'CA180432V0190', 'CA181532V0027', 'CA183332V0116', 'CA216632V0325', 'CA212332V0035', 'CA180032V0027', 'CA196532V0013', 'CA174432V0253', 'CA182432V0006', 'CA182532V0097', 'CA182432V0003', 'CA214232V0125', 'CA181332V0130', 'CA180732V0001', 'CA214232V0193', 'CA204132V0040', 'CA172032V0272', 'CA172032V0273', 'CA204032V0368', 'CA171932V0115', 'CA512332V0113', 'CA172032V0232', 'CA172032V0270', 'CA512032V0007', 'CA204032V0367', 'CA189332V0285', 'CA198232V0003', 'CA512332V0116', 'CA189832V0249', 'CA512332V0128', 'CA172232V0080', 'CA512332V0083', 'CA196732V0070', 'CA204032V0308', 'CA204032V0383', 'CA204032V0410', 'CA198232V0001', 'CA512332V0056', 'CA203932V0191', 'CA512332V0080', 'CA512332V0142', 'CA204032V0395', 'CA135832V0091', 'CA512332V0115', 'CA214232V0194', 'CA182432V0086', 'CA213532V0316', 'CA183132V0073', 'CA182432V0021', 'CA214132V0099', 'CA216632V0316', 'CA207432V0160', 'CA216532V0240', 'CA214132V0069', 'CA181432V0021', 'CA214232V0178', 'CA213532V0311', 'CA213532V0298', 'CA214232V0168', 'CA216332V0171', 'CA214232V0192', 'CA182532V0074', 'CA214232V0175', 'CA182232V0064', 'CA172232V0085', 'CA184532V0252', 'CA182732V0015', 'CA181832V0013', 'CA204032V0364', 'CA182332V0012', 'CA203932V0279', 'CA184432V0136', 'CA184732V0020', 'CA512332V0035', 'CA512332V0121', 'CA512732V0117', 'CA204032V0322', 'CA512332V0131', 'CA216332V0155', 'CA174732V0194', 'CA183032V0043', 'CA182432V0015', 'CA216732V0350', 'CA184732V0023', 'CA216332V0174', 'CA196732V0100', 'CA182432V0081', 'CA216632V0327', 'CA184432V0180', 'CA184632V0282', 'CA182432V0109', 'CA184732V0070', 'CA182332V0046', 'CA199332V0201', 'CA182232V0070', 'CA214132V0076', 'CA199332V0180', 'CA214232V0135', 'CA182232V0003', 'CA181832V0018', 'CA183432V0019', 'CA213332V0269', 'CA196932V0178', 'CA216432V0224', 'CA196732V0080', 'CA180332V0183', 'CA216332V0145', 'CA184632V0281', 'CA196832V0135', 'CA184832V0112', 'CA181032V0169', 'CA184432V0143', 'CA216632V0318', 'CA182432V0055', 'CA184332V0048', 'CA181632V0135', 'CA196632V0034', 'CA213432V0288', 'CA180132V0117', 'CA196632V0058', 'CA181632V0023', 'CA196932V0159', 'CA184432V0132', 'CA183432V0003', 'CA181332V0094', 'CA180032V0016', 'CA184332V0019', 'CA216532V0250', 'CA182332V0088', 'CA181532V0035', 'CA183532V0078', 'CA180732V0027', 'CA181232V0066', 'CA182532V0070', 'CA180032V0033', 'CA181632V0159', 'CA182432V0054', 'CA182432V0009', 'CA213532V0317', 'CA182232V0068', 'CA183332V0059', 'CA216332V0150', 'CA183132V0006', 'CA184432V0142', 'CA196932V0176', 'CA183432V0034', 'CA184732V0019', 'CA182232V0062', 'CA181232V0053', 'CA182532V0069', 'CA184532V0266', 'CA182432V0085', 'CA181232V0052', 'CA184332V0006', 'CA180432V0189', 'CA184432V0163', 'CA184332V0061', 'CA181632V0013', 'CA181832V0017', 'CA199332V0199', 'CA181332V0100', 'CA216332V0162', 'CA216332V0172', 'CA214132V0073', 'CA184732V0071', 'CA181832V0042', 'CA183432V0028', 'CA182532V0046', 'CA196232V0029', 'CA184932V0246', 'CA184832V0127', 'CA216532V0249', 'CA184832V0133', 'CA207332V0138', 'CA183532V0094', 'CA181232V0050', 'CA216632V0272', 'CA184332V0075', 'CA196832V0139', 'CA216632V0330', 'CA180332V0175', 'CA182232V0065', 'CA180732V0030', 'CA214232V0196', 'CA180132V0140', 'CA174132V0281', 'CA216432V0238', 'CA184732V0027', 'CA196932V0162', 'CA196732V0078', 'CA216532V0252', 'CA213532V0314', 'CA180332V0179', 'CA183332V0097', 'CA212332V0047', 'CA164432V0069', 'CA181532V0030', 'CA183132V0020', 'CA182732V0021', 'CA180032V0018', 'CA181232V0051', 'CA183332V0149', 'CA216132V0040', 'CA216732V0337', 'CA174732V0185', 'CA196632V0050', 'CA196732V0077', 'CA182232V0087', 'CA212332V0045', 'CA183432V0042', 'CA184732V0059', 'CA216132V0082', 'CA184432V0115', 'CA180032V0077', 'CA182532V0055', 'CA184332V0077', 'CA180032V0032', 'CA182932V0011', 'CA184532V0236', 'CA180332V0171', 'CA182532V0044', 'CA213432V0285', 'CA216532V0244', 'CA196932V0169', 'CA212432V0105', 'CA180332V0174', 'CA183432V0008', 'CA184332V0089', 'CA213532V0303', 'CA181332V0142', 'CA216332V0151', 'CA183532V0091', 'CA184732V0083', 'CA196932V0179', 'CA216632V0281', 'CA182332V0028', 'CA213532V0299', 'CA182232V0095', 'CA182532V0115', 'CA181432V0027', 'CA181632V0027', 'CA180432V0195', 'CA182232V0002', 'CA184432V0166', 'CA182332V0023', 'CA184432V0164', 'CA183432V0010', 'CA212332V0015', 'CA183332V0155', 'CA182432V0080', 'CA180032V0040', 'CA180132V0089', 'CA196832V0149', 'CA182532V0099', 'CA184432V0149', 'CA181032V0168', 'CA184332V0058', 'CA182532V0017', 'CA182232V0029', 'CA184632V0301', 'CA196232V0037', 'CA216132V0041', 'CA184832V0104', 'CA184732V0051', 'CA183432V0044', 'CA181332V0139', 'CA180132V0094', 'CA184532V0235', 'CA184832V0118', 'CA184532V0223', 'CA182532V0005', 'CA183332V0127', 'CA180032V0020', 'CA164432V0031', 'CA184432V0145', 'CA216132V0076', 'CA182632V0056', 'CA184332V0063', 'CA180032V0072', 'CA196232V0031', 'CA184432V0100', 'CA181632V0161', 'CA183532V0084', 'CA183432V0011', 'CA182532V0025', 'CA183532V0060', 'CA181632V0037', 'CA184532V0220', 'CA184432V0160', 'CA184732V0068', 'CA182732V0053', 'CA181532V0009', 'CA183432V0039', 'CA198232V0005', 'CA189332V0286', 'CA182532V0067', 'CA204032V0397', 'CA182532V0075', 'CA216132V0043', 'CA216132V0049', 'CA216132V0064', 'CA182232V0076', 'CA164432V0079', 'CA216132V0042', 'CA199332V0179', 'CA184432V0144', 'CA184432V0135', 'CA216032V0038', 'CA174432V0252', 'CA183332V0041', 'CA183532V0041', 'CA183332V0093', 'CA180032V0075', 'CA184832V0102', 'CA214032V0360', 'CA216532V0262', 'CA184732V0040', 'CA216632V0288', 'CA184932V0236', 'CA216632V0296', 'CA216632V0283', 'CA216032V0031', 'CA212432V0106', 'CA182332V0093', 'CA183332V0089', 'CA184632V0374', 'CA196632V0028']
    lst_too_few_tps = ['CA182532V0068', 'CA216432V0185', 'CA184732V0060', 'CA182332V0095', 'CA216132V0047', 'CA164432V0074', 'CA182232V0033', 'CA182432V0014', 'CA180532V0044', 'CA181632V0139', 'CA182632V0126', 'CA183532V0001', 'CA196232V0021', 'CA182732V0046', 'CA216432V0191', 'CA216532V0242', 'CA183132V0007', 'CA184332V0090', 'CA180732V0011', 'CA196332V0065', 'CA199332V0182', 'CA196232V0012', 'CA216132V0045', 'CA182432V0010', 'CA172032V0253', 'CA182932V0043', 'CA174132V0277', 'CA184932V0254', 'CA183132V0068', 'CA182232V0027', 'CA180732V0029', 'CA183232V0026', 'CA184832V0101', 'CA181832V0014', 'CA174132V0279', 'CA181632V0118', 'CA183132V0047', 'CA183232V0005', 'CA196332V0062', 'CA172232V0074', 'CA184732V0021', 'CA216632V0284', 'CA182132V0174', 'CA174232V0080', 'CA512732V0103', 'CA207332V0076', 'CA196532V0012', 'CA183432V0023', 'CA199432V0207', 'CA512332V0141', 'CA184932V0197', 'CA216032V0033', 'CA184732V0055', 'CA204032V0362', 'CA182132V0022', 'CA174132V0269', 'CA183132V0033', 'CA183132V0027', 'CA183332V0071', 'CA216432V0183', 'CA212332V0051', 'CA184432V0131', 'CA180532V0001', 'CA189332V0305', 'CA182932V0044', 'CA183532V0077', 'CA196632V0037', 'CA184532V0200', 'CA184432V0174', 'CA184832V0159', 'CA181832V0029', 'CA216532V0257', 'CA182332V0015', 'CA196732V0095', 'CA182332V0059', 'CA216032V0007', 'CA183432V0045', 'CA182432V0037', 'CA172432V0273', 'CA199332V0197', 'CA182132V0008', 'CA184532V0214', 'CA196732V0096', 'CA196232V0055', 'CA182132V0087', 'CA216332V0164', 'CA196732V0092', 'CA184432V0134', 'CA183332V0016', 'CA196532V0016', 'CA181332V0124', 'CA213532V0304', 'CA183532V0065', 'CA196232V0047', 'CA199332V0186', 'CA196832V0121', 'CA184732V0017', 'CA164432V0089', 'CA181732V0020', 'CA183132V0024', 'CA184432V0159', 'CA198232V0004', 'CA181432V0028', 'CA189332V0313', 'CA183432V0047', 'CA183532V0068', 'CA183232V0073', 'CA183232V0038', 'CA207332V0075', 'CA512732V0121', 'CA184432V0183', 'CA196732V0091', 'CA181632V0001', 'CA184732V0066', 'CA196232V0015', 'CA216032V0009', 'CA204032V0356', 'CA184732V0014', 'CA182532V0084', 'CA184732V0091', 'CA172032V0233', 'CA184732V0093', 'CA184932V0284', 'CA196232V0013', 'CA182232V0054', 'CA183132V0075', 'CA182232V0030', 'CA182132V0005', 'CA182132V0153', 'CA181532V0076', 'CA182332V0024', 'CA196832V0127', 'CA184532V0239', 'CA216332V0153', 'CA184732V0030', 'CA214132V0085', 'CA181632V0032', 'CA184732V0053', 'CA213532V0309', 'CA183432V0027', 'CA184932V0188', 'CA184832V0158', 'CA182732V0059', 'CA182332V0081', 'CA196532V0010', 'CA196832V0134', 'CA183432V0032', 'CA183532V0054', 'CA181632V0145', 'CA180532V0013', 'CA181732V0017', 'CA196632V0039', 'CA182432V0018', 'CA196632V0054', 'CA184732V0011', 'CA216332V0146', 'CA216032V0006', 'CA184332V0012', 'CA182732V0045', 'CA174132V0270', 'CA184732V0089', 'CA182332V0001', 'CA213332V0268', 'CA180032V0022', 'CA182332V0103', 'CA183532V0008', 'CA182232V0096', 'CA181632V0133', 'CA183132V0070', 'CA183432V0024', 'CA216632V0332', 'CA183532V0081', 'CA182132V0067', 'CA199332V0191', 'CA183332V0055', 'CA184432V0140', 'CA181232V0060', 'CA196832V0146', 'CA184932V0200', 'CA182132V0042', 'CA180732V0039', 'CA181232V0059', 'CA184332V0038', 'CA180732V0031', 'CA184832V0113', 'CA183532V0090', 'CA174132V0271', 'CA216132V0072', 'CA196232V0043', 'CA184932V0198', 'CA216132V0071', 'CA196232V0049', 'CA182732V0042', 'CA183132V0004', 'CA180032V0038', 'CA196232V0030', 'CA183432V0041', 'CA184932V0204', 'CA184932V0245', 'CA182132V0104', 'CA184732V0012', 'CA196732V0101', 'CA184432V0102', 'CA182932V0040', 'CA183132V0074', 'CA199332V0181', 'CA182932V0006', 'CA183032V0003', 'CA184632V0298', 'CA184932V0244', 'CA183132V0078', 'CA214132V0086', 'CA184932V0282', 'CA181832V0025', 'CA196232V0033', 'CA182332V0097', 'CA196232V0010', 'CA214232V0190', 'CA180032V0026', 'CA180532V0005', 'CA182532V0048', 'CA182432V0071', 'CA216632V0297', 'CA181632V0011', 'CA184932V0223', 'CA184732V0045', 'CA216032V0027', 'CA183532V0053', 'CA182732V0016', 'CA216132V0067', 'CA196832V0122', 'CA184632V0372', 'CA180132V0164', 'CA196232V0025', 'CA184432V0133', 'CA207332V0122', 'CA184932V0247', 'CA184932V0240', 'CA196732V0071', 'CA181632V0036', 'CA183132V0048', 'CA184832V0134', 'CA184932V0253', 'CA182332V0074', 'CA216632V0319', 'CA183432V0035', 'CA183332V0019', 'CA184532V0218', 'CA216732V0334', 'CA180732V0032', 'CA182932V0045', 'CA184432V0105', 'CA196932V0156', 'CA213532V0302', 'CA184832V0140', 'CA214232V0191', 'CA196232V0051', 'CA216132V0044', 'CA184632V0366', 'CA180432V0191', 'CA183532V0039', 'CA184332V0017', 'CA183532V0024', 'CA181332V0127', 'CA183232V0035', 'CA181632V0112', 'CA183132V0025', 'CA182332V0087', 'CA216032V0030', 'CA184732V0010', 'CA182432V0095', 'CA182432V0079', 'CA184432V0185', 'CA196632V0041', 'CA183532V0033', 'CA181532V0028', 'CA184732V0048', 'CA184432V0187', 'CA183432V0018', 'CA164432V0076', 'CA182132V0107', 'CA196932V0182', 'CA182432V0052', 'CA196932V0153', 'CA182432V0088', 'CA184432V0117', 'CA182332V0045', 'CA194232V0288', 'CA196732V0109', 'CA184832V0153', 'CA184632V0376', 'CA182332V0086', 'CA183432V0006', 'CA184632V0314', 'CA184832V0181', 'CA182132V0101', 'CA216532V0243', 'CA196532V0018', 'CA213332V0267', 'CA184532V0246', 'CA182232V0011', 'CA184932V0195', 'CA212132V0086', 'CA183132V0019', 'CA182432V0107', 'CA184732V0078', 'CA182232V0080', 'CA182432V0102', 'CA196632V0057', 'CA182332V0101', 'CA184632V0357', 'CA184632V0369', 'CA181632V0115', 'CA184632V0381', 'CA196232V0048', 'CA182432V0038', 'CA184632V0284', 'CA183432V0026', 'CA182632V0123', 'CA184632V0378', 'CA183532V0086', 'CA181532V0039', 'CA183532V0034', 'CA182132V0080', 'CA196632V0053', 'CA214132V0088', 'CA183332V0084', 'CA184932V0241', 'CA182332V0018', 'CA181532V0033', 'CA181632V0014', 'CA184632V0279', 'CA216432V0181', 'CA182132V0155', 'CA216132V0046', 'CA184932V0260', 'CA184932V0274', 'CA184532V0274', 'CA196932V0160', 'CA216032V0013', 'CA182332V0070', 'CA183532V0035', 'CA184432V0138', 'CA187632V0117', 'CA183232V0071', 'CA184732V0056', 'CA182232V0111', 'CA196932V0174', 'CA183532V0044', 'CA180332V0176', 'CA182732V0033', 'CA184632V0312', 'CA183532V0015', 'CA183532V0016', 'CA164432V0071', 'CA184832V0117', 'CA183132V0011', 'CA181732V0027', 'CA183332V0018', 'CA216132V0062', 'CA182232V0108', 'CA184432V0110', 'CA181232V0058', 'CA216132V0079', 'CA181532V0029', 'CA183532V0062', 'CA184332V0043', 'CA216332V0161', 'CA183132V0035', 'CA182632V0072', 'CA184532V0199', 'CA182432V0005', 'CA184932V0209', 'CA196332V0066', 'CA184832V0096', 'CA184732V0063', 'CA183532V0007', 'CA182432V0091', 'CA184732V0039', 'CA216732V0344', 'CA183132V0008', 'CA196232V0014', 'CA181832V0026', 'CA184932V0250', 'CA181632V0111', 'CA182732V0056', 'CA184532V0251', 'CA184532V0217', 'CA216732V0341', 'CA184832V0142', 'CA182232V0106', 'CA182332V0020', 'CA182232V0047', 'CA184332V0018', 'CA216432V0195', 'CA181332V0141', 'CA182432V0101', 'CA196732V0075', 'CA184632V0278', 'CA196232V0050', 'CA174232V0079', 'CA180232V0167', 'CA182432V0067', 'CA181632V0040', 'CA182632V0084', 'CA184932V0184', 'CA182232V0093', 'CA182732V0043', 'CA182732V0032', 'CA184832V0115', 'CA181232V0072', 'CA183532V0051', 'CA216632V0282', 'CA184832V0131', 'CA184832V0135', 'CA182432V0073', 'CA213532V0297', 'CA182432V0072', 'CA183232V0017', 'CA180232V0168', 'CA196732V0102', 'CA184532V0267', 'CA181332V0096', 'CA182532V0049', 'CA181732V0023', 'CA182532V0082', 'CA184532V0241', 'CA184932V0226', 'CA184932V0194', 'CA182532V0078', 'CA196732V0105', 'CA174432V0251', 'CA182532V0079', 'CA180032V0036', 'CA214132V0101', 'CA183132V0001', 'CA183532V0052', 'CA196732V0097', 'CA182332V0032', 'CA184832V0163', 'CA184732V0076', 'CA181632V0031', 'CA196832V0128', 'CA182532V0072', 'CA182732V0026', 'CA183232V0001', 'CA183532V0057', 'CA213532V0306', 'CA183232V0039', 'CA183432V0004', 'CA183532V0049', 'CA183332V0092', 'CA216432V0234', 'CA183532V0045', 'CA182532V0092', 'CA216632V0320', 'CA182432V0108', 'CA183232V0074', 'CA184332V0022', 'CA182232V0038', 'CA184332V0052', 'CA183232V0003', 'CA183232V0004', 'CA182432V0076', 'CA216532V0256', 'CA184732V0072', 'CA184732V0035', 'CA182432V0047', 'CA216332V0158', 'CA180432V0192', 'CA182932V0016', 'CA164432V0075', 'CA181632V0025', 'CA183532V0075', 'CA184832V0168', 'CA181232V0077', 'CA183132V0021', 'CA184832V0143', 'CA184732V0033', 'CA184332V0083', 'CA216332V0173', 'CA213532V0305', 'CA180532V0017', 'CA182332V0096', 'CA181432V0022', 'CA183232V0016', 'CA183332V0015', 'CA196232V0017', 'CA183532V0085', 'CA184532V0244', 'CA196632V0064', 'CA184732V0050', 'CA182732V0030', 'CA182232V0083', 'CA184832V0138', 'CA181632V0163', 'CA196232V0020', 'CA184432V0169', 'CA183432V0022', 'CA182632V0071', 'CA184632V0299', 'CA182332V0005', 'CA180232V0170', 'CA184332V0039', 'CA196232V0022', 'CA182432V0068', 'CA183532V0018', 'CA213332V0270', 'CA216132V0078', 'CA183532V0021', 'CA184832V0136', 'CA196532V0008', 'CA196832V0116', 'CA182332V0044', 'CA183532V0067', 'CA182232V0091', 'CA182132V0103', 'CA184432V0101', 'CA184532V0272', 'CA182432V0019', 'CA182532V0101', 'CA182332V0036', 'CA182332V0057', 'CA196332V0063', 'CA181332V0095', 'CA180232V0165', 'CA216332V0166', 'CA196232V0011', 'CA164432V0077', 'CA183032V0013', 'CA182132V0081', 'CA183532V0088', 'CA181732V0030', 'CA182532V0051', 'CA196632V0063', 'CA196332V0059', 'CA182432V0007', 'CA184832V0144', 'CA184432V0171', 'CA182332V0098', 'CA182732V0044', 'CA196932V0171', 'CA216032V0020', 'CA180132V0084', 'CA184532V0273', 'CA181632V0048', 'CA183232V0078', 'CA184332V0081', 'CA196732V0086', 'CA216032V0028', 'CA184632V0344', 'CA184732V0047', 'CA182732V0013', 'CA181332V0093', 'CA182432V0030', 'CA184432V0128', 'CA183532V0013', 'CA212132V0074', 'CA183032V0035', 'CA184532V0249', 'CA183432V0031', 'CA183532V0050', 'CA183232V0046', 'CA212332V0019', 'CA182532V0077', 'CA182432V0105', 'CA196632V0062', 'CA216432V0231', 'CA182332V0038', 'CA183532V0019', 'CA182632V0074', 'CA214232V0195', 'CA182932V0037', 'CA184732V0005', 'CA184732V0052', 'CA216532V0246', 'CA216432V0229', 'CA216532V0254', 'CA182232V0061', 'CA216432V0230', 'CA182332V0075', 'CA183132V0003', 'CA183032V0052', 'CA182532V0057', 'CA196732V0088', 'CA182332V0102', 'CA182432V0084', 'CA181532V0013', 'CA184732V0054', 'CA182232V0107', 'CA184932V0271', 'CA180532V0020', 'CA184832V0114', 'CA184332V0064', 'CA181632V0050', 'CA216332V0170', 'CA181832V0048', 'CA183232V0037', 'CA182132V0132', 'CA216632V0329', 'CA213532V0320', 'CA183332V0108', 'CA216632V0271', 'CA183532V0047', 'CA196532V0021', 'CA183532V0095', 'CA182332V0010', 'CA182332V0027', 'CA183532V0030', 'CA183032V0041', 'CA213532V0300', 'CA196932V0163', 'CA183532V0092', 'CA196832V0130', 'CA183532V0003', 'CA181532V0012', 'CA184632V0347', 'CA183332V0012', 'CA184432V0162', 'CA183532V0043', 'CA182632V0085', 'CA182232V0066', 'CA184632V0343', 'CA183432V0014', 'CA216132V0066', 'CA183232V0025', 'CA216632V0321', 'CA180032V0025', 'CA182332V0007', 'CA184432V0097', 'CA182632V0052', 'CA182732V0062', 'CA182632V0050', 'CA183532V0059', 'CA196332V0060', 'CA184432V0175', 'CA216032V0011', 'CA183332V0043', 'CA182232V0114', 'CA180532V0004', 'CA216632V0280', 'CA184932V0232', 'CA182332V0047', 'CA181632V0033', 'CA216732V0345', 'CA216132V0057', 'CA182232V0092', 'CA182732V0061', 'CA182232V0013', 'CA182232V0110', 'CA182132V0176', 'CA182432V0020', 'CA181532V0018', 'CA182132V0095', 'CA216532V0241', 'CA216332V0165', 'CA216432V0222', 'CA182232V0097', 'CA180532V0008', 'CA184532V0228', 'CA181532V0031', 'CA184732V0061', 'CA196632V0049', 'CA184632V0377', 'CA216132V0056', 'CA182432V0002', 'CA181632V0029', 'CA216332V0178', 'CA196532V0015', 'CA183232V0052', 'CA183232V0079', 'CA182332V0085', 'CA184332V0008', 'CA181632V0103', 'CA180732V0040', 'CA181332V0099', 'CA182732V0020', 'CA183432V0002', 'CA212432V0061', 'CA184832V0139', 'CA182532V0033', 'CA182332V0019', 'CA212132V0083', 'CA182232V0099', 'CA183532V0061', 'CA216332V0157', 'CA184432V0146', 'CA183332V0137', 'CA204032V0404', 'CA183332V0053', 'CA213532V0307', 'CA183332V0034', 'CA184432V0148', 'CA184532V0270', 'CA182632V0128', 'CA181632V0138', 'CA216332V0147', 'CA182232V0034', 'CA182232V0084', 'CA182132V0043', 'CA212332V0034', 'CA180432V0197', 'CA180432V0193', 'CA183232V0070', 'CA184832V0132', 'CA184932V0224', 'CA184332V0016', 'CA182132V0134', 'CA184732V0085', 'CA184332V0033', 'CA181532V0024', 'CA196232V0018', 'CA182532V0053', 'CA183132V0026', 'CA174632V0180', 'CA216132V0059', 'CA187632V0121', 'CA216132V0052', 'CA182732V0011', 'CA184832V0124', 'CA184932V0205', 'CA216632V0310', 'CA183432V0037', 'CA196232V0009', 'CA189332V0308', 'CA216732V0339', 'CA184832V0129', 'CA184632V0294', 'CA184532V0206', 'CA183332V0119', 'CA184532V0271', 'CA196232V0026', 'CA184632V0371', 'CA181532V0022', 'CA184632V0338', 'CA181232V0080', 'CA182432V0093', 'CA203932V0306', 'CA184932V0228', 'CA174132V0282', 'CA184732V0006', 'CA182132V0012', 'CA180032V0043', 'CA183232V0006', 'CA182732V0012', 'CA207432V0220', 'CA182632V0073', 'CA184932V0206', 'CA184732V0073', 'CA182432V0053', 'CA182532V0083', 'CA172032V0260', 'CA171932V0106', 'CA172132V0288', 'CA171932V0103', 'CA204032V0334', 'CA171932V0112', 'CA189832V0255', 'CA204232V0153', 'CA204132V0039', 'CA204032V0333', 'CA204232V0146', 'CA204232V0154', 'CA204032V0379', 'CA198232V0032', 'CA204032V0355', 'CA204032V0418', 'CA198232V0035', 'CA172532V0010', 'CA512732V0124', 'CA189332V0310', 'CA189832V0257', 'CA203932V0189', 'CA204032V0407', 'CA172432V0274', 'CA512332V0133', 'CA198232V0025', 'CA204032V0352', 'CA189332V0288', 'CA512732V0098', 'CA189332V0284', 'CA204332V0238', 'CA512332V0111', 'CA512332V0139', 'CA204032V0390', 'CA171932V0113', 'CA512332V0031', 'CA189832V0251', 'CA512332V0093', 'CA512332V0041', 'CA512332V0104', 'CA189832V0277', 'CA189332V0312', 'CA204032V0360', 'CA198232V0037', 'CA512532V0052', 'CA172232V0081', 'CA203932V0277', 'CA204032V0315', 'CA512032V0014', 'CA198232V0024', 'CA512332V0070', 'CA204032V0369', 'CA512332V0110', 'CA512332V0092', 'CA204032V0331', 'CA204032V0399', 'CA184932V0191', 'CA172232V0092', 'CA172232V0084', 'CA512332V0057', 'CA189332V0298', 'CA512432V0006', 'CA204032V0380', 'CA204032V0398', 'CA512332V0069', 'CA198232V0027', 'CA512332V0042', 'CA204032V0393', 'CA172532V0001', 'CA204032V0377', 'CA204032V0353', 'CA512032V0021', 'CA512032V0022', 'CA512732V0113', 'CA189332V0307', 'CA198232V0026', 'CA198232V0036', 'CA172032V0256', 'CA512632V0091', 'CA512732V0135', 'CA512332V0049', 'CA512332V0079', 'CA512332V0058', 'CA512332V0136', 'CA512332V0032', 'CA512332V0134', 'CA512332V0072', 'CA512732V0101', 'CA512332V0100', 'CA512332V0060', 'CA512732V0107', 'CA512332V0106', 'CA203932V0281', 'CA204032V0321', 'CA512032V0015', 'CA189332V0309', 'CA512732V0102', 'CA204032V0408', 'CA189332V0296', 'CA512332V0081', 'CA204032V0406', 'CA203932V0192', 'CA512332V0135', 'CA512432V0013', 'CA204032V0371', 'CA204032V0391', 'CA172332V0179', 'CA204232V0149', 'CA512432V0014', 'CA184732V0079', 'CA182732V0017', 'CA512732V0126', 'CA512332V0064', 'CA204032V0329', 'CA512732V0112', 'CA189332V0282', 'CA189332V0290', 'CA512332V0073', 'CA512732V0108', 'CA512332V0059', 'CA512732V0133', 'CA204032V0363', 'CA512632V0090', 'CA512732V0122', 'CA204032V0400', 'CA189332V0299', 'CA512032V0005', 'CA512632V0088', 'CA512732V0119', 'CA512032V0002', 'CA512732V0110', 'CA512332V0066', 'CA512732V0106', 'CA204032V0358', 'CA204232V0147', 'CA189332V0302', 'CA512332V0039', 'CA512332V0107', 'CA196232V0007', 'CA216632V0322', 'CA184632V0296', 'CA182432V0017', 'CA183232V0047', 'CA182432V0024', 'CA216132V0081', 'CA184532V0245', 'CA184832V0109', 'CA184432V0141', 'CA182332V0048', 'CA174632V0172', 'CA182232V0032', 'CA183532V0083', 'CA196232V0052', 'CA216632V0331', 'CA184932V0214', 'CA182432V0008', 'CA182432V0092', 'CA183132V0023', 'CA182432V0032', 'CA196232V0057', 'CA196932V0157', 'CA214232V0177', 'CA183432V0013', 'CA199332V0187', 'CA182332V0072', 'CA183232V0062', 'CA182332V0014', 'CA184432V0186', 'CA182232V0109', 'CA196232V0041', 'CA182132V0057', 'CA213532V0312', 'CA216532V0264', 'CA182432V0066', 'CA182232V0055', 'CA182532V0064', 'CA182432V0103', 'CA213532V0301', 'CA180732V0037', 'CA212132V0017', 'CA213432V0286', 'CA196632V0059', 'CA181632V0116', 'CA184932V0255', 'CA213432V0284', 'CA183332V0072', 'CA196732V0094', 'CA216632V0328', 'CA512332V0074', 'CA182432V0042', 'CA180332V0177', 'CA182532V0056', 'CA182432V0099', 'CA182332V0009', 'CA196932V0184', 'CA164432V0055', 'CA204032V0313', 'CA214232V0173', 'CA184332V0049', 'CA213532V0310', 'CA182432V0011', 'CA172032V0269', 'CA184632V0292', 'CA183232V0015', 'CA196732V0107', 'CA184432V0093', 'CA212132V0073', 'CA182432V0031', 'CA183132V0076', 'CA182232V0072', 'CA216332V0143', 'CA182232V0098', 'CA184732V0075', 'CA196932V0170', 'CA196532V0011', 'CA216432V0179', 'CA216032V0029', 'CA216332V0160', 'CA512032V0004', 'CA182432V0077', 'CA199332V0188', 'CA203932V0307', 'CA184932V0222', 'CA184832V0128', 'CA182232V0014', 'CA182432V0048', 'CA512332V0102', 'CA198232V0006', 'CA196732V0108', 'CA182432V0045', 'CA204032V0348', 'CA204032V0415', 'CA203932V0181', 'CA512332V0068', 'CA512332V0103', 'CA204032V0357', 'CA512332V0082', 'CA189332V0316', 'CA204032V0325', 'CA512432V0019', 'CA512332V0030', 'CA189332V0291', 'CA512732V0132', 'CA512332V0062', 'CA204032V0401', 'CA204032V0386', 'CA189332V0293', 'CA512732V0130', 'CA512432V0012', 'CA512732V0099', 'CA512432V0018', 'CA512332V0085', 'CA204032V0403', 'CA512732V0120', 'CA512332V0037', 'CA204232V0148', 'CA196732V0085', 'CA182332V0034', 'CA182232V0113', 'CA184432V0104', 'CA207432V0173', 'CA182432V0070', 'CA184632V0383', 'CA184332V0037', 'CA196932V0168', 'CA182432V0074', 'CA182232V0059', 'CA182232V0088', 'CA183432V0025', 'CA183032V0046', 'CA182232V0067', 'CA182132V0100', 'CA184432V0153', 'CA182432V0062', 'CA214132V0087', 'CA181532V0010', 'CA213432V0287', 'CA182432V0064', 'CA184432V0176', 'CA182432V0104', 'CA182332V0073', 'CA182232V0075', 'CA182232V0058', 'CA183532V0048', 'CA196832V0119', 'CA214232V0176', 'CA199332V0190', 'CA196232V0046', 'CA184732V0067', 'CA182432V0012', 'CA184432V0098', 'CA180732V0008', 'CA182232V0105', 'CA196932V0158', 'CA196932V0180', 'CA196732V0087', 'CA196632V0036', 'CA184532V0197', 'CA183432V0046', 'CA182432V0094', 'CA184432V0096', 'CA181632V0077', 'CA214232V0189', 'CA196232V0042', 'CA182332V0090', 'CA184932V0220', 'CA196232V0044', 'CA196232V0023', 'CA180132V0136', 'CA182332V0056', 'CA196532V0014', 'CA183232V0048', 'CA212132V0018', 'CA216632V0326', 'CA216732V0342', 'CA182332V0011', 'CA182332V0071', 'CA182432V0075', 'CA216532V0248', 'CA183132V0049', 'CA196732V0103', 'CA182432V0089', 'CA184932V0261', 'CA216532V0260', 'CA184332V0046', 'CA182232V0035', 'CA182332V0030', 'CA180132V0152', 'CA182332V0049', 'CA182432V0098', 'CA213332V0271', 'CA182232V0078', 'CA183232V0076', 'CA216732V0335', 'CA181432V0045', 'CA199332V0193', 'CA182232V0089', 'CA216332V0156', 'CA182432V0046', 'CA182432V0100', 'CA174732V0184', 'CA184932V0242', 'CA216432V0226', 'CA184932V0212', 'CA184432V0118', 'CA182432V0097', 'CA182632V0051', 'CA184532V0192', 'CA196232V0032', 'CA184332V0080', 'CA216432V0227', 'CA182432V0013', 'CA182132V0178', 'CA181632V0026', 'CA184832V0182', 'CA182732V0055', 'CA196232V0036', 'CA196832V0123', 'CA182432V0069', 'CA212132V0062', 'CA180132V0143', 'CA182132V0014', 'CA216432V0180', 'CA216332V0144', 'CA196732V0099', 'CA174332V0239', 'CA184732V0032', 'CA196732V0098', 'CA183532V0025', 'CA184832V0097', 'CA182432V0016', 'CA182532V0042', 'CA182232V0090', 'CA184832V0098', 'CA180732V0015', 'CA196232V0016', 'CA196232V0038', 'CA182932V0041', 'CA214132V0102', 'CA183232V0057', 'CA196732V0084', 'CA183432V0048', 'CA196732V0112', 'CA184832V0125', 'CA183232V0051', 'CA181632V0012', 'CA184932V0210', 'CA184532V0226', 'CA216332V0148', 'CA184832V0119', 'CA184432V0168', 'CA216032V0008', 'CA184332V0062', 'CA181232V0001', 'CA184532V0227', 'CA196232V0024', 'CA181632V0039', 'CA183332V0054', 'CA184432V0165', 'CA183032V0054', 'CA182732V0035', 'CA174132V0274', 'CA216332V0169', 'CA184932V0251', 'CA196232V0045', 'CA180732V0033', 'CA182332V0031', 'CA181632V0128', 'CA196232V0008', 'CA196932V0185', 'CA182332V0058', 'CA216432V0225', 'CA184732V0038', 'CA216132V0051', 'CA183532V0031', 'CA196832V0120', 'CA183532V0037', 'CA196332V0058', 'CA184832V0141', 'CA183432V0016', 'CA182432V0090', 'CA184932V0234', 'CA181632V0162', 'CA199332V0198', 'CA182732V0034', 'CA199332V0184', 'CA184632V0346', 'CA182332V0037', 'CA182132V0106', 'CA174132V0278', 'CA196732V0106', 'CA184732V0069', 'CA184632V0290', 'CA183432V0009', 'CA184732V0018', 'CA181632V0182', 'CA214232V0187', 'CA184932V0207', 'CA214132V0115', 'CA216632V0270', 'CA196632V0035', 'CA183532V0079', 'CA212132V0056', 'CA182332V0002', 'CA182732V0025', 'CA182932V0038', 'CA184432V0112', 'CA184332V0051', 'CA183332V0062', 'CA184432V0116', 'CA181632V0018', 'CA181632V0160', 'CA182932V0042', 'CA184532V0231', 'CA184332V0041', 'CA182132V0013', 'CA184632V0285', 'CA216032V0014', 'CA184432V0172', 'CA182432V0041', 'CA182132V0099', 'CA184932V0252', 'CA184332V0036', 'CA180132V0153', 'CA180032V0044', 'CA196832V0133', 'CA196632V0044', 'CA181732V0026', 'CA196832V0124', 'CA182232V0081', 'CA182232V0063', 'CA184932V0249', 'CA182332V0008', 'CA214232V0174', 'CA183432V0043', 'CA182432V0025', 'CA196632V0031', 'CA196732V0090', 'CA174332V0240', 'CA184932V0258', 'CA196732V0073', 'CA184532V0225', 'CA184332V0005', 'CA180132V0139', 'CA213532V0319', 'CA174132V0276', 'CA182732V0057', 'CA182732V0038', 'CA183332V0073', 'CA183432V0033', 'CA182332V0033', 'CA184632V0345', 'CA184832V0100', 'CA182432V0078', 'CA182532V0071', 'CA180032V0029', 'CA184932V0199', 'CA216132V0050', 'CA183332V0056', 'CA181332V0107', 'CA184432V0127', 'CA196732V0072', 'CA213532V0315', 'CA184532V0202', 'CA183032V0042', 'CA183132V0022', 'CA180432V0198', 'CA184632V0375', 'CA196832V0126', 'CA182132V0025', 'CA196732V0113', 'CA196932V0166', 'CA183532V0022', 'CA213432V0295', 'CA183232V0061', 'CA183532V0036', 'CA216332V0168', 'CA182232V0074', 'CA196832V0117', 'CA182432V0040', 'CA181632V0140', 'CA213432V0283', 'CA184532V0240', 'CA183132V0077', 'CA184332V0009', 'CA216132V0055', 'CA182232V0069', 'CA184932V0256', 'CA182432V0044', 'CA196232V0039', 'CA216132V0069', 'CA180032V0041', 'CA196832V0141', 'CA182132V0076', 'CA196532V0019', 'CA196732V0069', 'CA181732V0001', 'CA164432V0080', 'CA183532V0017', 'CA182232V0112', 'CA174432V0258', 'CA182332V0068', 'CA184932V0272', 'CA182432V0028', 'CA184332V0011', 'CA184632V0280', 'CA182732V0010', 'CA174232V0053', 'CA216032V0005', 'CA181632V0028', 'CA183532V0026', 'CA184932V0265', 'CA184332V0086', 'CA196832V0118', 'CA196532V0022', 'CA183432V0050', 'CA183532V0073', 'CA184932V0243', 'CA183432V0012', 'CA183032V0001', 'CA182232V0026', 'CA181632V0060', 'CA216632V0307', 'CA184732V0074', 'CA181232V0037', 'CA174432V0292', 'CA184832V0137', 'CA184532V0215', 'CA184532V0208', 'CA182132V0090', 'CA180032V0042', 'CA184732V0013', 'CA182132V0175', 'CA181232V0054', 'CA184532V0253', 'CA196832V0131', 'CA182232V0094', 'CA180432V0185', 'CA182232V0057', 'CA184332V0020', 'CA184432V0151', 'CA183532V0042', 'CA212132V0057', 'CA183232V0068', 'CA182432V0043', 'CA182132V0026', 'CA216432V0235', 'CA184632V0339', 'CA196732V0104', 'CA196632V0065', 'CA184932V0267', 'CA182732V0022', 'CA184932V0225', 'CA184832V0169', 'CA182132V0006', 'CA184932V0273', 'CA196532V0005', 'CA196732V0114', 'CA196232V0005', 'CA182332V0013', 'CA196932V0181', 'CA182332V0035', 'CA182232V0031', 'CA199332V0185', 'CA181832V0049', 'CA216632V0279', 'CA196732V0093', 'CA184732V0086', 'CA180032V0034', 'CA184632V0302', 'CA181632V0038', 'CA184432V0158', 'CA174732V0186', 'CA182232V0079', 'CA184632V0283', 'CA184432V0103', 'CA216432V0232', 'CA184432V0154', 'CA182332V0021', 'CA182732V0060', 'CA184532V0201', 'CA182732V0027', 'CA216432V0197', 'CA184532V0268', 'CA184432V0157', 'CA216532V0245', 'CA183532V0069', 'CA180232V0166', 'CA216532V0253', 'CA181232V0075', 'CA216632V0323', 'CA184532V0204', 'CA182432V0065', 'CA181832V0053', 'CA196232V0027', 'CA214232V0188', 'CA180032V0024', 'CA183232V0042', 'CA183232V0024', 'CA180132V0141', 'CA182332V0040', 'CA182132V0071', 'CA182332V0051', 'CA180332V0172', 'CA184932V0213', 'CA196232V0006', 'CA184532V0238', 'CA181532V0036', 'CA216532V0251', 'CA216432V0188', 'CA184932V0235', 'CA182732V0024', 'CA184932V0216', 'CA216132V0039', 'CA182532V0114', 'CA183232V0056', 'CA216632V0268', 'CA212132V0058', 'CA182132V0102', 'CA181632V0143', 'CA184832V0167', 'CA183232V0040', 'CA216332V0177', 'CA212432V0118', 'CA181632V0107', 'CA180032V0035', 'CA184532V0237', 'CA180032V0060', 'CA181632V0022', 'CA216532V0259', 'CA182232V0071', 'CA199332V0177', 'CA183532V0072', 'CA182432V0029', 'CA216132V0080', 'CA180032V0078', 'CA196832V0136', 'CA196632V0051', 'CA184432V0182', 'CA182132V0126', 'CA180432V0201', 'CA216632V0311', 'CA196832V0129', 'CA216032V0037', 'CA196732V0076', 'CA182232V0037', 'CA184832V0099', 'CA182532V0006', 'CA183432V0030', 'CA184932V0233', 'CA199432V0208', 'CA216132V0063', 'CA183332V0057', 'CA184432V0188', 'CA184732V0046', 'CA184832V0126', 'CA216432V0223', 'CA183232V0063', 'CA184632V0311', 'CA184732V0031', 'CA182932V0036', 'CA182432V0096', 'CA216532V0258', 'CA182932V0010', 'CA182432V0022', 'CA181832V0009', 'CA182132V0004', 'CA183432V0038', 'CA196232V0054', 'CA180532V0041', 'CA196932V0175', 'CA181732V0035', 'CA184532V0198', 'CA184432V0167', 'CA183232V0049', 'CA183532V0020', 'CA216032V0016', 'CA184932V0217', 'CA196332V0067', 'CA212132V0059', 'CA182132V0077', 'CA184432V0121', 'CA184432V0099', 'CA196532V0020', 'CA182432V0063', 'CA183132V0069', 'CA182432V0051', 'CA196932V0173', 'CA196232V0019', 'CA182132V0086', 'CA181532V0025', 'CA183132V0034', 'CA183132V0050', 'CA182332V0022', 'CA181732V0028', 'CA184832V0164', 'CA183332V0014', 'CA196732V0089', 'CA184732V0004', 'CA182432V0036', 'CA183332V0013', 'CA216032V0017', 'CA181632V0117', 'CA182932V0039', 'CA183432V0020', 'CA181632V0144', 'CA182332V0003', 'CA184432V0161', 'CA196632V0040', 'CA182132V0007', 'CA216032V0036', 'CA216432V0228', 'CA181632V0021', 'CA196532V0004', 'CA216432V0189', 'CA182432V0034', 'CA182132V0177', 'CA216632V0269', 'CA184432V0150', 'CA183232V0072', 'CA181832V0050', 'CA183532V0055', 'CA182232V0086', 'CA216432V0182', 'CA184832V0130', 'CA216632V0324', 'CA184932V0283', 'CA183532V0004', 'CA183132V0010', 'CA183532V0046', 'CA184332V0047', 'CA196632V0066', 'CA180032V0045', 'CA182332V0006', 'CA182232V0012', 'CA182632V0055', 'CA196832V0125', 'CA216532V0247', 'CA216532V0265', 'CA183532V0064', 'CA182432V0049', 'CA184432V0106', 'CA196532V0007', 'CA180332V0178', 'CA180332V0180', 'CA183432V0036', 'CA183132V0031', 'CA181632V0051', 'CA183232V0041', 'CA184532V0259', 'CA182432V0039', 'CA184432V0119', 'CA184832V0116', 'CA183532V0066', 'CA180032V0054', 'CA182332V0029', 'CA183532V0056', 'CA184432V0126', 'CA184532V0269', 'CA182132V0133', 'CA184732V0036', 'CA183232V0075', 'CA184532V0224', 'CA181632V0052', 'CA182732V0028', 'CA184932V0203', 'CA184632V0297', 'CA182532V0098', 'CA184932V0248', 'CA181232V0036', 'CA183232V0002', 'CA196832V0144', 'CA216132V0065', 'CA184432V0178', 'CA182432V0050', 'CA181632V0164', 'CA182732V0054', 'CA184932V0263', 'CA182532V0089', 'CA180332V0173', 'CA184532V0275', 'CA182632V0124', 'CA196732V0074', 'CA184932V0266', 'CA183432V0021', 'CA184732V0044', 'CA196632V0052', 'CA180132V0080', 'CA216132V0060', 'CA184932V0262', 'CA184932V0276', 'CA184432V0095', 'CA181632V0049', 'CA183532V0029', 'CA184732V0077', 'CA199432V0209', 'CA183532V0093', 'CA184932V0201', 'CA184832V0105', 'CA216732V0333', 'CA182132V0127', 'CA181532V0045', 'CA196832V0140', 'CA182532V0100', 'CA183532V0028', 'CA181632V0174', 'CA183432V0029', 'CA216132V0070', 'CA181732V0006', 'CA184432V0147', 'CA196732V0110', 'CA181732V0019', 'CA181832V0027', 'CA184532V0254', 'CA182532V0018', 'CA183132V0032', 'CA184432V0129', 'CA180432V0188', 'CA182132V0009', 'CA184332V0014', 'CA180432V0204', 'CA182532V0085', 'CA181832V0043', 'CA184932V0270', 'CA183332V0023', 'CA181632V0047', 'CA183532V0027', 'CA184932V0215', 'CA183532V0074', 'CA183432V0015', 'CA182732V0029', 'CA184332V0026', 'CA184732V0057', 'CA183332V0001', 'CA184832V0177', 'CA181632V0024', 'CA183232V0081', 'CA181532V0017', 'CA182732V0018', 'CA182732V0031', 'CA181532V0014', 'CA180332V0184', 'CA183232V0019', 'CA182732V0051', 'CA199332V0200', 'CA172232V0067', 'CA189332V0280', 'CA172232V0083', 'CA172232V0068', 'CA172232V0079', 'CA172232V0086', 'CA172432V0270', 'CA172432V0265', 'CA204032V0388', 'CA216332V0152', 'CA204032V0311', 'CA204032V0382', 'CA203932V0187', 'CA182532V0076', 'CA183132V0009', 'CA182632V0122', 'CA183132V0067', 'CA216432V0186', 'CA189332V0289', 'CA182732V0009', 'CA213532V0296', 'CA199332V0196', 'CA212332V0048', 'CA196632V0061', 'CA196232V0034', 'CA196632V0038', 'CA196632V0060', 'CA182132V0084', 'CA183232V0018', 'CA216432V0194', 'CA172232V0082', 'CA198232V0002', 'CA174132V0280', 'CA174132V0266', 'CA174432V0255', 'CA216532V0263', 'CA174132V0268', 'CA216632V0287', 'CA183532V0082', 'CA216632V0286', 'CA184532V0243', 'CA183432V0040', 'CA182432V0026', 'CA216032V0034', 'CA184732V0037', 'CA184832V0111', 'CA196832V0147', 'CA216432V0187']

    # create new list
    lst_try_again = lst_invalid + lst_too_few_tps

    # now that we have already a bunch of geo-referenced images we can estimate the positions of images
    print("Geo-reference with satellite images and estimated positions")

    for image_id in (pbar := tqdm(lst_try_again)):

        p.print_v(f"Work on {image_id} ({len(lst_georeferenced)} georeferenced, {len(lst_failed)} failed, "
                  f"{len(lst_invalid)} invalid, {len(lst_too_few_tps)} too few_tps, "
                  f"{len(lst_complexity)} too simple", pbar=pbar)

        # get an estimated position and approx_footprint
        try:
            _, footprint_estimated = dip.derive_image_position(image_id)
        except (Exception,):
            footprint_estimated = None

        # try again with estimated position
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", category=RuntimeWarning)
            status = gs.georef_sat(image_id, existing_footprint=footprint_estimated,
                                   retry_too_few_tps=True, retry_invalid=True,
                                   locate_image=False,
                                   overwrite=False, catch=False)

        if status == "georeferenced":

            # remove from try again list & add to successful list
            lst_georeferenced.append(image_id)
            if image_id in lst_invalid:
                lst_invalid.remove(image_id)
            if image_id in lst_too_few_tps:
                lst_too_few_tps.remove(image_id)

        elif status == "invalid" or status == "too_few_tps":
            # do nothing
            pass

        # worst outcome --> there's an error
        elif status == "failed":

            # remove from try again list & add to failed list
            lst_failed.append(image_id)
            if image_id in lst_invalid:
                lst_invalid.remove(image_id)
            if image_id in lst_too_few_tps:
                lst_too_few_tps.remove(image_id)

    print("Georeferenced:", len(lst_georeferenced))
    print("Failed:", len(lst_failed))
    print("Invalid:", len(lst_invalid))
    print("Too few tps:", len(lst_too_few_tps))
    print("Complexity:", len(lst_complexity))

    exit()

    # copy try again list (for iterating)
    lst_try_again_copy = copy.deepcopy(lst_try_again)

    # as a final step we try to geo-reference images with other images
    for image_id in tqdm(lst_try_again_copy):

        status = gi.georef_img(image_id)

        if status == "georeferenced":

            # remove from try again list & add to successful list
            lst_try_again.remove(image_id)
            lst_georeferenced.append(image_id)

        elif status == "invalid" or status == "too_few_tps":
            # do nothing
            pass

        # worst outcome --> there's an error
        elif status == "failed":

            # remove from try again list & add to failed list
            lst_try_again.remove(image_id)
            lst_failed.append(image_id)


if __name__ == "__main__":

    georef_all()
